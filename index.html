<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Driehoek uit afstanden</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: sans-serif; height: 100vh; display: flex; }
    #left { width: 40%; padding: 10px; border-right: 1px solid #ccc; }
    #right { width: 60%; padding: 10px; }
    label { display: block; margin-top: 6px; }
    input { width: 100%; padding: 4px; margin-top: 2px; }
    button { margin-top: 10px; padding: 6px 10px; }
    svg { width: 100%; height: calc(100vh - 20px); border: 1px solid #ccc; background: #fafafa; }
    .point { fill: #0074D9; stroke: #003366; stroke-width: 1; }
    .point-label { font-size: 11px; fill: #000; }
    .segment { stroke: #111; stroke-width: 1.5; }
    .error { color: #b00; margin-top: 8px; }
  </style>
</head>
<body>
  <div id="left">
    <h3>Driehoek uit afstanden</h3>
    <p>Voer de drie zijden van een driehoek in (in dezelfde eenheid):</p>

    <label>
      Afstand P1–P2
      <input type="number" step="0.01" id="d12" value="5.40">
    </label>
    <label>
      Afstand P2–P3
      <input type="number" step="0.01" id="d23" value="8.83">
    </label>
    <label>
      Afstand P3–P1
      <input type="number" step="0.01" id="d31" value="16.05">
    </label>

    <button id="drawBtn">Teken driehoek</button>
    <div id="msg" class="error"></div>
  </div>

  <div id="right">
    <svg id="svg" viewBox="-10 -10 20 20"></svg>
  </div>

<script>
const d12Input = document.getElementById('d12');
const d23Input = document.getElementById('d23');
const d31Input = document.getElementById('d31');
const drawBtn  = document.getElementById('drawBtn');
const msgEl    = document.getElementById('msg');
const svg      = document.getElementById('svg');

drawBtn.addEventListener('click', () => {
  msgEl.textContent = '';
  const d12 = parseFloat(d12Input.value);
  const d23 = parseFloat(d23Input.value);
  const d31 = parseFloat(d31Input.value);

  if (!isFinite(d12) || !isFinite(d23) || !isFinite(d31) ||
      d12 <= 0 || d23 <= 0 || d31 <= 0) {
    msgEl.textContent = 'Alle afstanden moeten positieve getallen zijn.';
    clearSvg();
    return;
  }

  const pts = triangleFromDistances(d12, d23, d31);
  if (!pts) {
    msgEl.textContent = 'Geen geldige driehoek: schending van de driehoeksongelijkheid of numerieke fout.';
    clearSvg();
    return;
  }

  drawTriangleSvg(svg, pts);
});

// Bereken coördinaten van driehoek uit drie zijden
function triangleFromDistances(d12, d23, d31) {
  // Driehoeksongelijkheid checken
  if (d12 + d23 <= d31 || d12 + d31 <= d23 || d23 + d31 <= d12) {
    return null;
  }

  // P1 = (0,0)
  const x1 = 0, y1 = 0;

  // P2 = (d12, 0)
  const x2 = d12, y2 = 0;

  // P3 uit snijpunten van twee cirkels met straal d31 en d23
  const a  = d12;
  const r1 = d31;
  const r2 = d23;

  // Formule voor x3 langs de x-as
  const x3 = (r1*r1 - r2*r2 + a*a) / (2*a);
  const under = r1*r1 - x3*x3;
  if (under < 0) {
    // Door afrondingsfouten kan dit net onder 0 komen
    if (under > -1e-8) {
      return [
        {id:'P1', x:x1, y:y1},
        {id:'P2', x:x2, y:y2},
        {id:'P3', x:x3, y:0}
      ];
    }
    return null;
  }
  const y3 = Math.sqrt(under); // kies de “bovenste” oplossing

  return [
    {id:'P1', x:x1, y:y1},
    {id:'P2', x:x2, y:y2},
    {id:'P3', x:x3, y:y3}
  ];
}

function drawTriangleSvg(svg, pts) {
  clearSvg();

  const [p1, p2, p3] = pts;
  const xs = pts.map(p => p.x);
  const ys = pts.map(p => p.y);
  const minX = Math.min(...xs), maxX = Math.max(...xs);
  const minY = Math.min(...ys), maxY = Math.max(...ys);
  const pad  = 0.5 * Math.max(maxX - minX, maxY - minY, 1);

  const viewMinX = minX - pad;
  const viewMinY = minY - pad;
  const viewW = (maxX - minX) + 2 * pad;
  const viewH = (maxY - minY) + 2 * pad;

  svg.setAttribute('viewBox', `${viewMinX} ${viewMinY} ${viewW} ${viewH}`);

  // segmenten
  drawSegment(svg, p1, p2);
  drawSegment(svg, p2, p3);
  drawSegment(svg, p3, p1);

  // punten + labels
  const r = Math.max(0.02 * Math.max(viewW, viewH), 0.05);
  pts.forEach(p => {
    const c = document.createElementNS('http://www.w3.org/2000/svg','circle');
    c.setAttribute('cx', p.x);
    c.setAttribute('cy', p.y);
    c.setAttribute('r', r);
    c.setAttribute('class','point');
    svg.appendChild(c);

    const label = document.createElementNS('http://www.w3.org/2000/svg','text');
    label.setAttribute('x', p.x + r*1.5);
    label.setAttribute('y', p.y - r*1.5);
    label.setAttribute('class','point-label');
    label.textContent = p.id;
    svg.appendChild(label);
  });
}

function drawSegment(svg, a, b) {
  const line = document.createElementNS('http://www.w3.org/2000/svg','line');
  line.setAttribute('x1', a.x);
  line.setAttribute('y1', a.y);
  line.setAttribute('x2', b.x);
  line.setAttribute('y2', b.y);
  line.setAttribute('class','segment');
  svg.appendChild(line);
}

function clearSvg() {
  while (svg.firstChild) svg.removeChild(svg.firstChild);
}

// eerste keer tekenen met defaultwaarden
drawBtn.click();
</script>
</body>
</html>
